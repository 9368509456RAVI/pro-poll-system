<!DOCTYPE html>
<html>
<head>
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:sans-serif;background:#111;color:white;padding:20px}
button{padding:10px 15px;margin:5px;border:none;border-radius:6px;cursor:pointer}
</style>
</head>
<body>

<h2>ðŸ›  Admin Dashboard</h2>
  <button onclick="openPoll()">Open Poll</button>
<button onclick="closePoll()">Close Poll</button>
<a href="/api/export"><button>Download Votes.txt</button></a>

<canvas id="chart" height="200"></canvas>

<script>
async function loadChart(){
  const res = await fetch('/api/results');
  const data = await res.json();

  const labels = data.map(d=>d._id);
  const counts = data.map(d=>d.count);

  new Chart(document.getElementById('chart'),{
    type:'pie',
    data:{labels:labels,datasets:[{data:counts}]}
  });
}

async function closePoll(){
  await fetch('/api/close');
  alert("Poll Closed");
}
  
async function openPoll(){
  await fetch('/api/open');
  alert("Poll Reopened âœ…");
}
loadChart();
  setInterval(loadChart, 5000);
</script>
</body>
</html>



